<!doctype html>
<html lang="vi">
<head>
    <meta property="og:title" content="DermAI - Ứng dụng AI hỗ trợ chẩn đoán bệnh da liễu">
    <meta property="og:description" content="Ứng dụng AI hỗ trợ chẩn đoán các bệnh về da liễu nhanh chóng và chính xác. Sử dụng trí tuệ nhân tạo và thị giác máy tính để phân tích hình ảnh da và cung cấp các chẩn đoán kịp thời.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://litclub.pythonanywhere.com/">
    <meta property="og:image" content="https://scontent.fhan15-2.fna.fbcdn.net/v/t39.30808-6/517737809_122100053498943826_3327007350081078447_n.png?_nc_cat=107&ccb=1-7&_nc_sid=cc71e4&_nc_ohc=edONUK9z7kkQ7kNvwGrcQv7&_nc_oc=AdkRdS-VL0_JPfxBJv-XMhR_XPRw6BcxfGIvM441XgvNj4YQEuV7E0WNzscIUV9WT8I&_nc_zt=23&_nc_ht=scontent.fhan15-2.fna&_nc_gid=oQXmcf39N5CEF7QDQIN0hw&oh=00_AfTGO5IfzsEbxFCqddWx-S-7SJlJnywSnTXyjgdq0DteCQ&oe=68801A5D">
    <meta property="og:site_name" content="DermAI - Ứng dụng AI hỗ trợ chẩn đoán bệnh da liễu">

    <link rel="shortcut icon" href="https://github.com/Codedr-edu/DermAI/blob/main/media/Thi%E1%BA%BFt%20k%E1%BA%BF%20ch%C6%B0a%20c%C3%B3%20t%C3%AAn.png?raw=true" type="image/x-icon">

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Kết quả phân tích - DermAI</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background: linear-gradient(135deg, #f8fafc 0%, #e8f0ff 100%); padding-bottom: 76px; }
        .result-container { max-width: 800px; margin: 20px auto; }
        .result-card { border-radius: 12px; background: #fff; box-shadow: 0 8px 20px rgba(15,23,42,0.06); padding: 20px; margin-bottom: 20px; }
        .prediction-list { list-style: none; padding: 0; }
        .prediction-item { padding: 10px; border-bottom: 1px solid #eee; }
        .prediction-item:last-child { border-bottom: none; }
        .heatmap-img { max-width: 100%; height: auto; border-radius: 8px; }
    </style>
</head>
<body class="vh-100 d-flex flex-column align-items-center">
    <div class="result-container w-100">
        <div class="d-flex align-items-center mb-3">
            <div class="brand fs-4 fw-bold me-3">DermAI</div>
            <div class="hint text-muted">Kết quả phân tích da</div>
        </div>

        <div class="result-card text-center">
            <h5 class="mb-3">Ảnh đã tải lên</h5>
            <img src="{{ skin_image.image.url }}" alt="Uploaded Skin Image" class="img-fluid mb-3 rounded" style="max-width: 300px; height: 300px;">

            <h5 class="mb-3">Kết quả chẩn đoán sơ bộ</h5>
                        <table class="table table-striped table-hover">
                            <thead class="table-dark">
                                <tr>
                                    <th>Tên bệnh</th>
                                    <th>Phần trăm dự đoán</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for pred in skin_image.result %}
                                <tr>
                                    <td><strong>{{ pred.class }}</strong></td>
                                    <td>{{ pred.probability|floatformat:2 }}%</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>

                        <p class="text-danger mb-3">*DermAI có thể có những nhầm lẫn trong việc chẩn đoán. Vui lòng tham khảo ý kiến bác sĩ để có chẩn đoán chính xác.</p>
                        <p class="text-danger mb-3">*Nếu bạn có chuyên môn y khoa. Hãy kiểm tra thật kĩ tình trạng bệnh nhân bằng các biện pháp y khoa chuẩn. DermAI chỉ có khả năng hỗ trợ tốt nhất trong quá trình tiền chẩn đoán</p>
            <br>
            {% if skin_image.heatmap %}
            <div class="w-100 rounded" style="height:3px;background-color: gray;"></div>
            <br>

            <h5 class="mb-3">Heatmap giải thích</h5>
            <p class="text-muted small">Heatmap hiển thị các vùng ảnh mà AI tập trung để đưa ra dự đoán. Dữ liệu này có thể tham khảo bởi những người có chuyên môn y khoa</p>
            <img src="{{ skin_image.heatmap.url }}" alt="Grad-CAM Heatmap" class="heatmap-img">
            {% endif %}

            <div class="w-100 rounded" style="background-color:gray;height:3px; margin-top:20px;margin-bottom:30px;"></div>
            {% if not skin_image.explain %}
            <a data-bs-toggle="modal" data-bs-target="#exampleModal" class="btn btn-primary w-100 shadow-lg" >Thêm dữ liệu để chẩn đoán nâng cao</a>
            <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">Thêm thông tin</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                  </div>
                  <div class="modal-body">
                    <h3 class="text-center mb-3">Thêm thông tin</h3>
                    <form method="post" action="/predict/" enctype="multipart/form-data">
                      {% csrf_token %}
                      <div class="mb-3">
                        <div class="row">
                          <div class="col-lg">
                            <label>Giới tính bệnh nhân</label>
                            <select class="form-select w-100" name="gender" aria-label="Default select example" required>
                              <option selected>---</option>
                              <option value="Nam">Nam</option>
                              <option value="Nữ">Nữ</option>
                            </select>
                          </div>
                          <div class="col-lg">
                           <label>Độ tuổi bệnh nhân</label>
                           <input class="form-control w-100" name="age" type="number" required/> 
                          </div>
                        </div>
                      </div>
                      <div class="mb-3">
                        <div class="row">
                          <div class="col-lg">
                            <label>Triệu chứng</label>
                            <textarea class="form-control w-100" name="symptom" rows="3" placeholder="Mô tả triệu chứng..." required></textarea>
                          </div>
                        </div>
                      </div>
                      <div class="mb-3">
                        <div class="row">
                          <div class="col-lg">
                            <label>Tiền sử bệnh</label>
                            <textarea class="form-control w-100" name="illness_history" rows="3" placeholder="Mô tả các bệnh đã từng mắc..." required></textarea>
                          </div>
                          <div class="col-lg">
                            <label>Tiền sử thuốc</label>
                            <textarea class="form-control w-100" name="drug_history" rows="3" placeholder="Mô tả các loại thuốc từng dùng gần đây..." required></textarea>
                          </div>
                        </div>
                      </div>
                      <div class="mb-3">
                        <div class="row">
                          <div class="col-lg">
                            <button type="submit" class="w-100 btn btn-success">Gửi thông tin</button>
                          </div>
                        </div>
                      </div>
                    </form>
                  </div>
                </div>
              </div>
            </div>
            <br>
            {% else %}
            <a class="btn btn-primary w-100 shadow-lg" >Sửa dữ liệu để chẩn đoán nâng cao</a>
            <div class="modal fade" id="exampleModal1" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">Sửa thông tin</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                  </div>
                  <div class="modal-body">
                    <h3 class="text-center mb-3">Sửa thông tin</h3>
                    <form method="post" action="/predict/" enctype="multipart/form-data">
                      {% csrf_token %}
                      <div class="mb-3">
                        <div class="row">
                          <div class="col-lg">
                            <label>Giới tính bệnh nhân</label>
                            <select class="form-select w-100" name="gender" aria-label="Default select example" required>
                              <option selected>{{skin_image.gender}}</option>
                              <option value="Nam">Nam</option>
                              <option value="Nữ">Nữ</option>
                            </select>
                          </div>
                          <div class="col-lg">
                           <label>Độ tuổi bệnh nhân</label>
                           <input class="form-control w-100" name="age" type="number" placeholder="{{skin_image.age}}" required/> 
                          </div>
                        </div>
                      </div>
                      <div class="mb-3">
                        <div class="row">
                          <div class="col-lg">
                            <label>Triệu chứng</label>
                            <textarea class="form-control w-100" name="symptom" rows="3" placeholder="Mô tả triệu chứng..." required>{{skin_image.symptom}}</textarea>
                          </div>
                        </div>
                      </div>
                      <div class="mb-3">
                        <div class="row">
                          <div class="col-lg">
                            <label>Tiền sử bệnh</label>
                            <textarea class="form-control w-100" name="illness_history" rows="3" placeholder="Mô tả các bệnh đã từng mắc..." required>{{skin_image.illness_history}}</textarea>
                          </div>
                          <div class="col-lg">
                            <label>Tiền sử thuốc</label>
                            <textarea class="form-control w-100" name="drug_history" rows="3" placeholder="Mô tả các loại thuốc từng dùng gần đây..." required>{{skin_image.drug_history}}</textarea>
                          </div>
                        </div>
                      </div>
                      <div class="mb-3">
                        <div class="row">
                          <div class="col-lg">
                            <button type="submit" class="w-100 btn btn-success">Gửi thông tin</button>
                          </div>
                        </div>
                      </div>
                    </form>
                  </div>
                </div>
              </div>
            </div>
            <br>
            <h5 class="text-center mb-3 mt-3">Các thông tin liên quan</h5>
            <table class="table table-striped table-hover">
              <thead class="table-dark">
                <tr>
                    <td><strong>Loại thông tin</strong></td>
                    <td><strong>Chi tiết</strong></td>
                </tr>
              </thead>
              <tbody>
                <tr>
                    <td>Giới tính</td>
                    <td>{{ skin_image.gender}}</td>
                </tr>
                <tr>
                    <td>Độ tuổi</td>
                    <td>{{ skin_image.age }}</td>
                </tr>
                <tr>
                    <td>Triệu chứng</td>
                    <td>{{ skin_image.symptom }}</td>
                </tr>
                <tr>
                    <td>Tiền sử thuốc</td>
                    <td>{{ skin_image.drug_history}}</td>
                </tr>
                <tr>
                    <td>Tiền sử bệnh</td>
                    <td>{{ skin_image.illness_history }}</td>
                </tr>
                </tbody>
            </table>
            {% endif %}
        </div>

        <div class="text-center" style="margin-bottom: 10vh;">
            <a href="/" class="btn btn-primary">Quay lại trang chủ</a>
            <a href="/profile" class="btn btn-secondary">Xem hồ sơ</a>
        </div>
    </div>

    <!-- bottom navbar copied from home.html -->
    <nav class="navbar navbar-light bg-white border-top fixed-bottom">
      <div class="container d-flex justify-content-around py-2">
        <a href="/" class="d-flex flex-column align-items-center text-decoration-none text-muted">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-camera-fill" viewBox="0 0 16 16">
            <path d="M10.5 8.5a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0"/>
            <path d="M2 4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2h-1.172a2 2 0 0 1-1.414-.586l-.828-.828A2 2 0 0 0 9.172 2H6.828a2 2 0 0 0-1.414.586l-.828.828A2 2 0 0 1 3.172 4zm.5 2a.5.5 0 1 1 0-1 .5.5 0 0 1 0 1m9 2.5a3.5 3.5 0 1 1-7 0 3.5 3.5 0 0 1 7 0"/>
          </svg>
        </a>

        <!--<a href="/community" class="d-flex flex-column align-items-center text-decoration-none text-muted">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chat-square-quote-fill" viewBox="0 0 16 16">
            <path d="M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.5a1 1 0 0 0-.8.4l-1.9 2.533a1 1 0 0 1-1.6 0L5.3 12.4a1 1 0 0 0-.8-.4H2a2 2 0 0 1-2-2zm7.194 2.766a1.7 1.7 0 0 0-.227-.272 1.5 1.5 0 0 0-.469-.324l-.008-.004A1.8 1.8 0 0 0 5.734 4C4.776 4 4 4.746 4 5.667c0 .92.776 1.666 1.734 1.666.343 0 .662-.095.931-.26-.137.389-.39.804-.81 1.22a.405.405 0 0 0 .011.59c.173.16.447.155.614-.01 1.334-1.329 1.37-2.758.941-3.706a2.5 2.5 0 0 0-.227-.4zM11 7.073c-.136.389-.39.804-.81 1.22a.405.405 0 0 0 .012.59c.172.16.446.155.613-.01 1.334-1.329 1.37-2.758.942-3.706a2.5 2.5 0 0 0-.228-.4 1.7 1.7 0 0 0-.227-.273 1.5 1.5 0 0 0-.469-.324l-.008-.004A1.8 1.8 0 0 0 10.07 4c-.957 0-1.734.746-1.734 1.667 0 .92.777 1.666 1.734 1.666.343 0 .662-.095.931-.26"/>
          </svg>
        </a>-->

        <a href="/chatbot" class="d-flex flex-column align-items-center text-decoration-none text-muted">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="mb-1" viewBox="0 0 16 16">
            <path d="M2 2h12v9H5.414L3 13.414V2z"/>
          </svg>
        </a>

        <a href="/pharmacy" class="d-flex flex-column align-items-center text-decoration-none text-muted">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-capsule-pill" viewBox="0 0 16 16">
            <path d="M11.02 5.364a3 3 0 0 0-4.242-4.243L1.121 6.778a3 3 0 1 0 4.243 4.243l5.657-5.657Zm-6.413-.657 2.878-2.879a2 2 0 1 1 2.829 2.829L7.435 7.536zM12 8a4 4 0 1 1 0 8 4 4 0 0 1 0-8m-.5 1.042a3 3 0 0 0 0 5.917zm1 5.917a3 3 0 0 0 0-5.917z"/>
          </svg>
        </a>

        <a href="tel:115" class="d-flex flex-column align-items-center text-decoration-none text-danger">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="mb-1" viewBox="0 0 16 16">
            <path d="M3.654 1.328a.678.678 0 00-1.015-.063L1.605 2.298c-.483.48-.661 1.18-.45 1.803.35 1.098 1.07 2.78 2.65 4.36 1.58 1.58 3.262 2.3 4.36 2.65.623.211 1.323.033 1.803-.45l1.033-1.033a.678.678 0 00-.063-1.015l-2.07-1.552a.678.678 0 00-.58-.087l-1.52.507a.678.678 0 01-.657-.148L6.9 6.1a.678.678 0 00-.148-.657L6.255 4.9a.678.678 0 00-.087-.58L4.616 2.25z"/>
          </svg>
          <!--<small class="d-block">Gọi cấp cứu</small>-->
        </a>

        <a href="/profile" class="d-flex flex-column align-items-center text-decoration-none text-muted">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-circle" viewBox="0 0 16 16">
            <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0"/>
            <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1"/>
          </svg>
        </a>
      </div>
    </nav>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
